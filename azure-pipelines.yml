# Ruby
# Package your Ruby project.
# Add steps that install rails, analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/ruby

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: UseRubyVersion@0
  inputs:
    versionSpec: '>= 2.5'

- script: |
    sudo apt-get update
    sudo apt-get install rbenv ruby-build
    sudo apt-get install autoconf bison build-essential libssl-dev libyaml-dev libreadline6-dev zlib1g-dev libncurses5-dev libffi-dev libgdbm-dev
  displayName: 'install rbenv and ruby-build'

# - script: |
#     git clone https://github.com/rbenv/rbenv.git ~/.rbenv
#   displayName: 'install rbenv'

# - script: |
#     cd ~/.rbenv && src/configure && make -C src
#   displayName: 'move rbenv'

# - script: |
#     echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
#   displayName: 'add rbenv to path'

- script: |
    source ~/.bashrc
    source ~/.bash_profile
    rbenv install jruby
    rbenv local jruby
    jruby -S gem install bundler
  displayName: 'install jruby'
