input {
  file {
    path => "${FILE_PATH}"
    start_position => "beginning"
    # Need to set this explicitly, otherwise Logstash tries to use a path for which it cannot chown to the "logstash" user
    sincedb_path => "/dev/null"
  }
}

# Logstash 8.X ECS compatibility mode introduces this additional field with how the event looked originally when ingested
# by the pipeline. We don't want it as we want to run the same comparison independently of the Logstash version.
# See: https://discuss.elastic.co/t/logstash-8-x-ecs-compatibility-mode-adds-event-original/307654
# See: https://discuss.elastic.co/t/how-to-get-rid-of-event-original-field/303604/3
mutate {
  remove_field => ["[event][original]"]
}

output {
  newrelic {
    base_uri => "https://mockserver:443/log/v1"
    license_key => "${LICENSE_KEY}"
    custom_ca_cert => "${MOCKSERVER_CA_CERT_PATH}"
  }
}